---
title: "A quick assessment of PECA networks (RE only) on human complex traits"
author: "Xiang Zhu"
date: "2018-07-19"
output: workflowr::wflow_html
---

```{r, echo=FALSE}
suppressPackageStartupMessages(library(data.table))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(knitr))
```

## PECA networks

Below is an example of PECA networks (courtesy of Duren).
Columns 1-6 are TG, RE, TF, corr(TG, RE), corr(TG, TF)
and combined p-value for corr(TG, RE) and corr(TG, TF). 

```{r, echo=FALSE}
options(width=300)
peca_net <- data.table::fread("~/Downloads/TissueNet_merged/Tissue_network_Ovary.txt")
dplyr::sample_n(peca_net,5)
```

```{r, echo=FALSE}
net_files <- list.files("~/Downloads/TissueNet_merged/")
net_names <- gsub("Tissue_network_","",net_files)
net_names <- gsub(".txt","",net_names)
net_info <- data.frame(net_id=(1:length(net_names)),net_name=net_names,stringsAsFactors=FALSE)

dplyr::sample_n(net_info,5)
```

Note that here I only used the RE column of each network in the following analyses.

## Analysis methods

I run the same quick assessment on the RE parts of networks;
analysis details are the same as my [previous analysis](ashlrt_201peca_31trait.html).

## Full results

```{r, echo=FALSE}
res_mat <- readRDS("~/Dropbox/rss/Data/peca_human/out_market/peca_re_human_ashlrt_20180724.rds")
res_df <- as.data.frame(res_mat/log(10), row.names=NULL)
res_df$net_id <- (1:73)
res_df <- dplyr::inner_join(net_info, res_df, by="net_id")
```

```{r, echo=FALSE, results="asis", eval=TRUE}
trait_set <- colnames(res_mat)
num_trait <- length(trait_set)
#num_trait <- 2 # for testing

for (j in 1:num_trait) {
  cat(paste0('### Complex trait: ',trait_set[j],'\n')) 
  tmp_df <- res_df[, c("net_name","net_id",trait_set[j])]
  tmp_df <- tmp_df[order(tmp_df[[trait_set[j]]], decreasing=TRUE),]
  rownames(tmp_df) <- NULL
  print(knitr::kable(tmp_df))
  cat('\r\n\r\n')
}
```

