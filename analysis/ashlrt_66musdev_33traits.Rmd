---
title: "A quick assessment of MusDev lists on human complex traits"
author: "Xiang Zhu"
date: "2018-07-19"
output: workflowr::wflow_html
---

```{r, echo=FALSE}
suppressPackageStartupMessages(library(data.table))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(knitr))
```

## PECA networks

Below is an example of MusDev lists (courtesy of Duren).
Columns 1-3 are chr, start and stop. 

```{r, echo=FALSE}
options(width=300)
musdev_list <- data.table::fread("~/Downloads/mouse_development_enhancer_hg19/liver_P0_enhancr_U6.bed")
dplyr::sample_n(musdev_list,5)
```

There are 66 MusDev lists, each corresponding to a tissue at a given stage.

```{r, echo=FALSE}
bed_files <- list.files("~/Downloads/mouse_development_enhancer_hg19/")
bed_names <- gsub("_enhancr_U6.bed","",bed_files)
bed_info <- data.frame(bed_id=(1:length(bed_names)),bed_name=bed_names,stringsAsFactors=FALSE)

dplyr::sample_n(bed_info,5)
```

## Analysis methods

I run the same quick assessment on these MusDev lists;
analysis details are the same as my [previous analysis](ashlrt_201peca_31trait.html).

This simple analysis yields some findings in concordance with literature:

- Age at natural menopause --- MCF-7 (breast cancer cell line)
- Crohnâ€™s disease --- primary B cells from peripheral blood
- High-density lipoprotein --- HepG2 (liver cancer cell line)
- Heart rate --- Fetal Heart
- Rheumatoid arthritis --- CD8 Primary Cells
- Schizophrenia --- Primary T cells from cord blood
- Waist-hip ratio --- Fetal Muscle
- Atrial fibrillation --- Fetal Heart

## Full results

```{r, echo=FALSE}
res_mat <- readRDS("~/Dropbox/rss/Data/mouse_development_enhancer/out_market/musdev_ashlrt_20180724.rds")
res_df <- as.data.frame(res_mat/log(10), row.names=NULL)
res_df$bed_id <- (1:66)
res_df <- dplyr::inner_join(bed_info, res_df, by="bed_id")
```

```{r, echo=FALSE, results="asis", eval=TRUE}
trait_set <- colnames(res_mat)
num_trait <- length(trait_set)
#num_trait <- 2 # for testing

for (j in 1:num_trait) {
  cat(paste0('### Complex trait: ',trait_set[j],'\n')) 
  tmp_df <- res_df[, c("bed_name","bed_id",trait_set[j])]
  tmp_df <- tmp_df[order(tmp_df[[trait_set[j]]], decreasing=TRUE),]
  rownames(tmp_df) <- NULL
  print(knitr::kable(tmp_df))
  cat('\r\n\r\n')
}
```

